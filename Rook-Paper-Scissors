#include <iostream>
#include<cstdlib>
#include <ctime>
using namespace std;

enum enGameChoice { Rook = 1, Paper, Scissors };
enum enWinner { Player = 1, Computer, Draw };

struct stRoundsInfo
{
    short RoundsNumber = 0;
    enGameChoice PlayerChoice;
    enGameChoice ComputerChoice;
    enWinner RoundWinner;
    string WinnerName="";
};

struct stGameResults
{
    short GameRounds = 0;
    short PlayerWonTimes = 0;
    short ComputerWonTimes = 0;
    short DrawTimes = 0;
    enWinner GameWinner;
    string WinnerName = "";
};

int RandomNumber(int From, int To)
{
    int randNumber = rand() % (To - From + 1) + From;
    return randNumber;
}

string ChoiceName(enGameChoice Choice)
{
    string arrGameChoice[3] = { "Rook", "Paper", "Scissors" };
    return arrGameChoice[Choice - 1];
}

string WinnerName(enWinner Winner)
{
    string arrWinnerChoice[3] = { "Player", "Computer", "No Winner" };
    return arrWinnerChoice[Winner - 1];
}

enWinner WhoWonTheRound(stRoundsInfo RoundInfo)
{
    if (RoundInfo.PlayerChoice == RoundInfo.ComputerChoice)
        return enWinner::Draw;
    switch (RoundInfo.PlayerChoice)
    {
    case enGameChoice::Rook:
        if (RoundInfo.ComputerChoice == enGameChoice::Paper)
            return enWinner::Computer;
        break;

    case enGameChoice::Paper:
        if (RoundInfo.ComputerChoice == enGameChoice::Scissors)
            return enWinner::Computer;
        break;
        
    case enGameChoice::Scissors:
        if (RoundInfo.ComputerChoice == enGameChoice::Rook)
            return enWinner::Computer;
    }
    return enWinner::Player;
}

enWinner WhoWonTheGame(short PlayerWonTimes, short ComputerWonTimes)
{
    if (PlayerWonTimes > ComputerWonTimes)
        return enWinner::Player;
    else if (ComputerWonTimes > PlayerWonTimes)
        return enWinner::Computer;

    else
        return enWinner::Draw;
}

string Tabs(short NumberOfTabs)
{
    string t = "";
    for (int i = 1; i <= NumberOfTabs; i++)
    {
        t += "\t";
    }
    return t;
}

enGameChoice ReadPlayerChoice()
{
    short Choice;
    do
    {
        cout << "\nYour Choice: [1]:Rook ,[2]:Paper ,[3]:Scissors ? ";
        cin >> Choice;
    } while (Choice < 1 || Choice>3);

    return enGameChoice(Choice);
}

enGameChoice GetComputerChoice()
{
    return enGameChoice(RandomNumber(1, 3));
}

short HowManyRounds()
{
    short GameRounds = 1;
    do
    {
        cout << "How Many Rounds (1 TO 10) ? \n";
        cin >> GameRounds;

    } while (GameRounds < 1 || GameRounds>10);
    return GameRounds;
}

void SetWinnerScreenColor(enWinner Winner)
{
    switch (Winner)
    {
    case enWinner::Player:
        system("color 2F");
        break;
    case enWinner::Computer:
        system("color 4F");
        cout << "\a";
        break;
    default:
        system("color 6F");
    }
}

void PrintRoundResults(stRoundsInfo RoundInfo)
{
    cout << "____________________Round[" << RoundInfo.RoundsNumber << "]___________________\n" << endl;
    cout << "Player Choice: " <<ChoiceName(RoundInfo.PlayerChoice) << endl;
    cout << "Computer Choice: " <<ChoiceName(RoundInfo.ComputerChoice) << endl;
    cout << "Round Winner: " <<WinnerName( RoundInfo.RoundWinner )<< endl;
    cout << "_______________________________________________\n\n";

    SetWinnerScreenColor(RoundInfo.RoundWinner);
}

void PrintGameFinalResults(stGameResults GameResults)
{
    cout <<Tabs(2)<< "_________________________[Game Results]_______________________\n\n";
    cout <<Tabs(2)<< "Game Rounds: " << GameResults.GameRounds << endl;
    cout <<Tabs(2)<< "Player Won Times: " << GameResults.PlayerWonTimes << endl;
    cout <<Tabs(2)<< "Computer Won Times: " << GameResults.ComputerWonTimes << endl;
    cout <<Tabs(2)<< "Draw Times: " << GameResults.DrawTimes << endl;
    cout <<Tabs(2)<< "Final Winner: " << GameResults.WinnerName << endl;
    cout <<Tabs(2)<< "______________________________________________________________\n";
    SetWinnerScreenColor(GameResults.GameWinner);
}

stGameResults FillGameResult(short GameRounds,short PlayerWonTimes,short ComputerWonTimes,short DrawTimes)
{
    stGameResults GameResults;
    GameResults.GameRounds = GameRounds;
    GameResults.PlayerWonTimes = PlayerWonTimes;
    GameResults.ComputerWonTimes = ComputerWonTimes;
    GameResults.DrawTimes = DrawTimes;
    GameResults.GameWinner = WhoWonTheGame(PlayerWonTimes,ComputerWonTimes);
    GameResults.WinnerName = WinnerName(GameResults.GameWinner);
    return GameResults;
}

void PrintGameOverScreen()
{
    cout << Tabs(2) << "______________________________________________________________\n\n";
    cout << Tabs(2) << "                      +++ Game Over +++"<< endl;
    cout << Tabs(2) << "______________________________________________________________\n\n";

}

stGameResults PlayGame(short HowManyRound)
{
    stRoundsInfo RoundInfo;

    short PlayerWonTimes = 0, ComputerWonTimes = 0, DrawTimes=0;

    for (short GameRound = 1; GameRound <= HowManyRound; GameRound++)
    {
        cout << "\nRounds[" << GameRound << "] Begins:\n";
        RoundInfo.RoundsNumber = GameRound;
        RoundInfo.PlayerChoice = ReadPlayerChoice();
        RoundInfo.ComputerChoice = GetComputerChoice();
        RoundInfo.RoundWinner = WhoWonTheRound(RoundInfo);
        RoundInfo.WinnerName = WinnerName(RoundInfo.RoundWinner);
         
        if (RoundInfo.RoundWinner == enWinner::Player)
            PlayerWonTimes++;
        else if (RoundInfo.RoundWinner == enWinner::Computer)
            ComputerWonTimes++;
        else
            DrawTimes++;
        PrintRoundResults(RoundInfo);
    }

    return FillGameResult(HowManyRound, PlayerWonTimes, ComputerWonTimes, DrawTimes);
}

void ResetScreen()
{
    system("cls");
    system("color 0F");

}

void StartGame()
{
    char PlayAgain = 'Y';
    cout << "\n========================================\n";
    cout << "     WELCOME TO MATH QUIZ GAME!        \n";
    cout << "========================================\n";

    do
    {

        ResetScreen();
        stGameResults GameResults = PlayGame(HowManyRounds());
        PrintGameOverScreen();
        PrintGameFinalResults(GameResults);

        cout <<endl<< Tabs(3) << "Do You Want To Play Again? Y/N? ";
        cin >> PlayAgain;
    } while (PlayAgain == 'Y' || PlayAgain == 'y');
    cout << "\nThank you for playing! Goodbye!\n";
}


int main()
{ 
    srand((unsigned)time(NULL));

    StartGame();

    system("pause>0");
   
    return 0;
}
